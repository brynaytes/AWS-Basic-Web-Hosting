{
  "Resources": {
    "SiteS3Bucket": {
      "Type": "AWS::S3::Bucket",
      "Properties": {
        "BucketName": "mine-sweeper-site-assets"
      }
    },
    "cloudfrontDistribution": {
      "DependsOn" : "SiteS3Bucket",
      "Type": "AWS::CloudFront::Distribution",
      "Properties": {
        "DistributionConfig" : {
          "DefaultCacheBehavior" : {
            "ViewerProtocolPolicy" : "allow-all",
            "TargetOriginId" :  {"Ref" :  "SiteS3Bucket"},
            "ForwardedValues" : {
              "QueryString" : false
            }
          } ,
          "Origins" : [ {
              "DomainName" : "mine-sweeper-site-assets.s3.amazonaws.com" ,
              "Id" :  {"Ref" :  "SiteS3Bucket"},
              "S3OriginConfig" : {
                "OriginAccessIdentity" : { "Fn::Join" : [ "", ["origin-access-identity/cloudfront/", {"Ref" : "cloudfrontOriginAccessIdentity"}] ] }

              }
          }],
          "Enabled" : true
        }
      }
    },
    "cloudfrontOriginAccessIdentity" : {
      "Type" : "AWS::CloudFront::CloudFrontOriginAccessIdentity",
      "Properties" : {
        "CloudFrontOriginAccessIdentityConfig" : {
          "Comment" : "Locking the S3 bucket"
        }      
      }
    }

  }
}